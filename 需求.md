 任务：

```
a) 限制不允许不接受任何环境变量传入； ->ok———————————————————————————————————-？？
b) 限制允许指定登录的用户和用户组登录； ->调试中 ——————————————————————————————ko
developer->system guest
c) 身份认证应采用公私钥认证和键盘交互式认证；->ok——————————————————————————————ko
password:iauto
d) 只允许配置CA允许的证书签名算法；->客户替换公钥私钥 RSA——————————————————————不需要
e) 应配置用户认证成功后可到达的访问目录，防止非授权访问；->DAC/MAC——---------———不需要
f) 应使用的对称加密算法，密钥长度AES128位以上；->ok——————————————————————————ko
g) 应配置会话超时时间不超过5分钟，防止会话泄露； ->ok ——————————————————————————kk
h) 应禁用所有网络转发功能；->ok————————————————————————————————————————————
i) 配置指纹采用HASH算法为sha256；->ok ——————————————————————————————————————ko
j) 应禁用超级管理员登录；->调试中 ———————————————————————————————————————————ko
k) 应采用PAM模块对密码复杂度等进行密码校验；->密码的复杂度依赖客户———————————————不需要
l) 应采用非对称密钥算法,密钥长度2048以上， 哈希算法应SHA256以上；->ok—————————— 
		HostKeyAlgorithms？ KexAlgorithms
m) 应配置消息认证算法，至少选用带etm的HMAC，使用sha256以上算法；->ok————————————ko
n) 身份认证失败最大尝试次数，不应该超过3次；->OK———————————————————————————————ko
o) 同时在线最大的会话个数，不应该超过4个；->OK————————————————————————————————？？
p) 不允许空密码登录；->OK  ————————————————————————————————————————————————ko
q) 吊销的公钥，应及时配置到吊销公钥列表；->system FOTA -------------------————不需要
r) 应开启调试级别以上日志功能；->TODO log存放路径  ———————————————————————————不需要
s) 应对ssh配置文件进行安全存储。->依赖security storage——————————————————————不需要
```



------



stdout, stdin, stderr的中文名字分别是标准输出，标准输入和标准错误。

[inode和文件描述符的关系](https://blog.csdn.net/liukuan73/article/details/78864620)

软连接硬链接？

```
在客户端随便创建一对密钥，把公钥放到服务端/etc/ssh/<名称>

错误：
$ ssh root@localhost -p 45000
sign_and_send_pubkey: signing failed: agent refused operation
Permission denied (publickey).
#和ssh_agent有关，kill它就好了

AuthorizedKeysFile一行的参数必须空格分开，才能识别2个参数，和顺序无关。写两条无效。
```



```c
git pull    //可以把远程分支列表搞过来
git branch -r     //查看所有远程分支
repo start branch –all xxxx  //切换全分支为xxx  ？？？

repo sync -c    //直接同步当前分支的全部东西
repo forall -c git checkout speed/release/WL_190904    //切换全部分支为xxx

git branch -r | grep speed
```



```
使用ssh连接dipper前所需的网络配置：
1.配置dipper，vlan要求为vlan61，ip根据用户要求确定
$ vconfig add eth0 61
$ ifconfig vlan61 192.168.70.1
$ ip route add table 97 192.168.70.0/24 via 192.168.70.1 dev vlan61
（ip route show table 97）???

2.PC：ifconfig  查看本地信息，找到新的对应网卡，如：enp0s25
输入：$ sudo vconfig add enp0s25 61
     $ sudo ifconfig enp0s25.61 192.168.70.9
     $ sudo ip route add 192.168.70.0/24 via 192.168.70.9 dev enp0s25.61
$ ip route show table main
$ ping  192.168.70.1

实际网线测试user版本不可ping通,因为防火墙没有配置好。

从技术角度讲，VLAN的划分可依据不同原则，一般有以下三种划分方法：
```

https://blog.csdn.net/phunxm/article/details/9498829

http://cn.linux.vbird.org/linux_server/0110network_basic.php

二层三层交换机，

ARP广播，DHCP服务器



repo后如何添加分支

脚本实现ssh密码密钥输入

/system/usr/bin  /usr/bin 和 /bin有什么不同

修改的位置external/toybox  || system/core |openssh



再检查一些sepolicy sshd min  binder。。（）需要吗？问问zheng高山

binder_call是什么？

```
new task：
1.ucom和networkmanager的接口
		
將腳本發佈到/etc/NetworkManager/dispatcher.d中。
设置。
2.socket
3.网络监听

DHCP分配IP地址过程描述
https://blog.csdn.net/OPBocai/article/details/80852159
https://blog.csdn.net/lee244868149/article/details/45640351

sysd的TCP握手连接

```

看一下文件描述符、socket https://blog.csdn.net/cywosp/article/details/38965239

深入理解计算机系统中的 内存管理

内核空间基础

阻塞模式和非阻塞以及和socket通信的关联

https://www.zfl9.com/c-socket.html

https://www.csdn.net/article/1970-01-01/289672

[一个完整的软件研发流程是怎样的](https://www.infoq.cn/article/what-is-a-complete-software-development-process)





[adb认证过程](https://blog.csdn.net/u013463707/article/details/83013589)  

```
1.首先，linux原adb_key在哪儿，安卓在哪儿，/data/misc/adb/adb_keys
  手机端厂商公钥保存在/adb_keys中，来自授权主机的主机公钥保存在:/data/misc/adb/adb_keys  
  Linux主机密钥对在~/.android/里
3.ctl_adb.sh需要学习一下shell脚本
方法 加入adb shell

```



c++  可变参数用法  
va_list  va_start()   va_end

shell脚本

加班10/10：adb源码学习

加班10/11：dipper项目adb功能调试

10/12不急：adb不用脚本直接login，-c -的问题，或像ssh ifeq ($(TARGET_BUILD_VARIANT),user)
user_flag := -DUSER_FLAG
endif然后再源码中判断user eng 和路径

security  solution文件编写


线程通信与进程通信

多线程编程  理论

logcfg -c ssh   
logcat -s ssh



select函数完美 https://www.cnblogs.com/alantu2018/p/8612722.html  

研究memcpy  
代码规范！！  

对于sshd无法通过execle启动的问题：

1.在sshd.c内的fatal("sshd re-exec requires execution with an absolute path");这一步退出了。原因如log，所以问题在于参数，打印main(int ac, char **av)的参数，发现两种方式启动sshd传到main函数时参数不同，直接原因是缺少“/”，所以修改execle中的SSHD由sshd改为绝对路径名称。

（但是测试发现去掉fatal那一行，sshd依然能正常启动，但只能外部ssh连接一次？）

（-D -d对实际连接的影响未知，）

```
execle（原版参数有-D）
当参数为原版时输出： 				 sshd-f   -f/etc/   /etc/ssh    -D/syst
当参数SSHD改为SSHD_PATH时输出：  /system/   -f/etc/   /etc/ssh   -D/syst

命令行执行/system/usr/bin/sshd -f /etc/ssh/sshd_config：
原版输出：	 	/system/   -f/etc/   /etc/ssh
增加 -D 输出:	/system/	-f/etc/		/etc/ssh		-D_=/sy
增加-D -d 输出：/system/		-f/etc/		/etc/ssh		-D-d_=		-d_=/sy

```

```
AIDL是Android接口定义语言，拥有自己的语法和特性。
```

 《深入理解Android》 bind https://www.cnblogs.com/innost/archive/2011/01/09/1931456.html 

usr模式adb shell 无法成功 '/bin/login‘

因为没有加LOCAL_CFLAGS

init.rc分析  耦合

VLAN脸上，打开端口，直接起线程、   tlsd认证 tls

adb sshd 密码登录

 https://paul.pub/android-binder-cpp/ 

 https://www.jianshu.com/p/dafbc4751df7 



ifdef undef的作用域   ProtoType？？



init.rc详解

类交叉引用头文件测试



tlsd测试起dtlog和ota手顺

selinux信息结合logcat | grep -i selinux 一起看

设计模式

meiyuezongjie

https://www.cnblogs.com/wipan/p/9488318.html 进程线程号关系

**#define----由预处理器来处理**

**typedef----在编译阶段由编译器处理**

```
总之*,*如果二个头文件相互引用时*,*最好不是二个都用*#include.*

当然如果二个头文件中并没有用到另一个头文件中的类时*,*二个头文件是可以相互*#include*的*(*可以像前面那样自己把*#include*展开分析*):*
```

```
null指向了哪里new不delete而是指向null？
.h中加static的函数到.cpp中实现时候就不加了，c++调用类的静态方法
const int & b的效率  
string char* int 转化与static/const与函数参数传递与&
[Tlsd][sshnegotiate] Failed:socket create error\n
```

shell权限缩减

htons问题（socket标准写法）

char bootmode[2] = {
   '\0'
  };

https://blog.csdn.net/fuxingdaima/article/details/8540169{c与c++头文件}

http://www.sunistudio.com/cppfaq/mixing-c-and-cpp.html（c/c++混合编程）

https://www.cnblogs.com/skynet/archive/2010/07/10/1774964.html

https://blog.csdn.net/z1002137615/article/details/50772185（extern “c”）

https://blog.csdn.net/qq_33530388/article/details/60138971（头文件库文件、编译与链接）

```

1.开机不启动tlsd，车机连接pc/ubuntu，模拟获取到了vlan51的ip。
	然后手动启动tlsd，tlsd主动检测vlan51的ip，network成功返回正常ip；
	tlsd发起开启端口7838的请求并开始15秒timer，network开启7838端口，返回成功信息；
	tlsd启动ssl认证线程，pc/ubuntu端通过工具手动连接，通过认证，
	tlsd开启3端口22708（sshd），22709（fota），22710（lexport），network收到请求，返回成功打开的消息。
	tlsd开启3个进程。

1.开机启动tlsd，主动获取vlan51 ip，若获得则如1，若没有获得则等待network自己返回vlan51出现的ip。
	
case（tlsd与其相关调用的外部接口和时序相关case）：
1.tlsd开机启动时，vlan51 没有/有 准备好ip。
2.tlsd的ssl认证 通过/超时/没有超时但失败，后会怎么样。

在整个流程测试过后 收集avc，消除后再一次在enforing模式下最终测试。
目标：先测试整个流程  后消除avc
```

```
对接测试进度：
dhclient——tlsd  测试工具获取ip，tlsd成功收到ip信息 （ok）
tlsd--dhclient  tlsd调用接口打开端口，收到对方返回的消息（ok）
tlsd--log导出client  tlsd建立socket等待客户端工具连接，认证成功后调用接口打开三个端口（ok）
dhclient———tlsd   端口打开成功后返回消息给tlsd，tlsd打开3个进程 （ok）

recovery进度：
tlsd收到vlan51ip信息后————认证通过开启3个进程中的2个（ok）
测试log导出和fota的机能（others负责）
对接测试（待完成）

enforing模式下进度:
1.normal:
2.recovery:
```

recovery system文件系统，/etc的key和/system/etc放在哪一边 （根目录下的东西好像会复制到system目录?）



*<u>solution_security 问李春芳 vlan51 ip获取工具</u>*

release更新时，需要把5个提交再 cherrypick

------

```
MQTT协议
在通讯过程中，MQTT协议中有三种身份：发布者（Publish）、代理（Broker）（服务器）、订阅者（Subscribe）。其中，消息的发布者和订阅者都是客户端，消息代理是服务器，消息发布者可以同时是订阅者。
MQTT传输的消息分为：主题（Topic）和负载（payload）两部分：

（1）Topic，可以理解为消息的类型，订阅者订阅（Subscribe）后，就会收到该主题的消息内容（payload）；
（2）payload，可以理解为消息的内容，是指订阅者具体要使用的内容。


```

```c
zlib  minizip
接口  function（目标目录路径，生成zip文件名和路径）
     function
目前实现：
    1.
还需实现：
    空目录的压缩。
    目标不是目录而是文件 ————ok
    传入的目录后不要加/(可不实现，在接口传入参数前进行字符串的处理)
    不要把父目录的名称也压缩进去，只保留目标目录。-----ok 错误！！无法对非本地目录下内容压缩
    接口实现，生成库（后面考虑）
    
 注意：直接压缩一个空文件夹的实现
    只能找到程序允许所在目录的东西
    
```





```
函数：
zipOpen（）

```

